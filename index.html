<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>X-BET - Home</title>
    <style>
        /* [ALL YOUR EXISTING CSS REMAINS THE SAME - NO CHANGES] */
        /* ... all your CSS styles ... */
    </style>
</head>
<body>
    <!-- Header with Navigation -->
    <header class="header">
        <div class="nav-container">
            <nav class="nav">
                <div class="logo">
                    <h1>X<span>-BET</span></h1>
                </div>

                <!-- Desktop Navigation -->
                <div class="nav-links" id="navLinks">
                    <a href="index.html" class="active">Home</a>
                    <a href="games.html">Games</a>
                    <a href="dashboard.html" id="dashboardLink">Dashboard</a>
                    <a href="bits.html">Bits</a>
                    <a href="about.html">About</a>
                    <a href="contact.html">Contact</a>
                    
                    <!-- Balance Display - Only shown when logged in -->
                    <div class="balance-container" id="balanceContainer" style="display: none;">
                        <span class="balance-label">Balance</span>
                        <span class="balance-amount" id="userBalance">$0.00</span>
                        <span class="currency">USD</span>
                    </div>

                    <!-- Logged-in user actions (hidden by default) -->
                    <div id="loggedInActions" style="display: none;">
                        <a href="deposit.html" class="btn-secondary" style="padding: 8px 16px; font-size: 14px;">
                            Deposit
                        </a>
                        <a href="withdraw.html" class="btn-secondary" style="padding: 8px 16px; font-size: 14px;">
                            Withdraw
                        </a>
                        <a href="login.html" class="btn-primary" style="padding: 8px 16px; font-size: 14px;" id="logoutLink">
                            Logout
                        </a>
                    </div>

                    <!-- Guest user actions (shown by default) -->
                    <div id="guestActions">
                        <a href="login.html" class="btn-secondary" style="padding: 8px 16px; font-size: 14px;">
                            Login
                        </a>
                        <a href="signup.html" class="btn-primary" style="padding: 8px 16px; font-size: 14px;">
                            Sign Up
                        </a>
                    </div>
                </div>

                <!-- Mobile Menu Button -->
                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    â˜°
                </button>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-container">
        <!-- Hero Section -->
        <section class="hero">
            <h2>Welcome to X-BET Gaming Platform</h2>
            <p>Experience the thrill of premium gaming with instant withdrawals, secure transactions, and exclusive rewards.</p>
            <div class="cta-buttons">
                <a href="games.html" class="btn btn-primary">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
                    </svg>
                    Explore Games
                </a>
                <a href="dashboard.html" class="btn btn-secondary" id="dashboardBtn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/>
                    </svg>
                    Go to Dashboard
                </a>
            </div>
        </section>

        <!-- Features Section -->
        <section class="features">
            <div class="feature-card">
                <div class="feature-icon">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 2L4.5 20.29l.71.71L12 18l6.79 3 .71-.71z"/>
                    </svg>
                </div>
                <h3>Secure Gaming</h3>
                <p>Advanced encryption and secure protocols ensure your gaming experience is safe and protected at all times.</p>
            </div>

            <div class="feature-card">
                <div class="feature-icon">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>
                    </svg>
                </div>
                <h3>Instant Withdrawals</h3>
                <p>Get your winnings instantly with our fast withdrawal system. No delays, just pure convenience.</p>
            </div>

            <div class="feature-card">
                <div class="feature-icon">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                    </svg>
                </div>
                <h3>24/7 Support</h3>
                <p>Our dedicated support team is available around the clock to assist you with any questions or concerns.</p>
            </div>
        </section>

        <!-- Quick Actions -->
        <section class="quick-actions">
            <h3>Quick Actions</h3>
            <div class="action-grid">
                <a href="deposit.html" class="action-btn" id="depositAction">
                    <div class="action-icon">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                        </svg>
                    </div>
                    <div class="action-text">
                        <h4>Deposit Funds</h4>
                        <span>Add money to your account</span>
                    </div>
                </a>

                <a href="withdraw.html" class="action-btn" id="withdrawAction">
                    <div class="action-icon">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M17 10H7v2h10v-2zm2-7h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zm-5-5H7v2h7v-2z"/>
                        </svg>
                    </div>
                    <div class="action-text">
                        <h4>Withdraw Winnings</h4>
                        <span>Cash out your earnings</span>
                    </div>
                </a>

                <a href="games.html" class="action-btn">
                    <div class="action-icon">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M15 7.5V2H9v5.5l3 3 3-3zM7.5 9H2v6h5.5l3-3-3-3zM9 16.5V22h6v-5.5l-3-3-3 3zM16.5 9l-3 3 3 3H22V9h-5.5z"/>
                        </svg>
                    </div>
                    <div class="action-text">
                        <h4>Play Games</h4>
                        <span>Explore our game collection</span>
                    </div>
                </a>

                <a href="profile.html" class="action-btn" id="profileAction">
                    <div class="action-icon">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/>
                        </svg>
                    </div>
                    <div class="action-text">
                        <h4>Profile Settings</h4>
                        <span>Manage your account</span>
                    </div>
                </a>
            </div>
        </section>

        <!-- Recent Activity - Only shown when logged in -->
        <section class="recent-activity" id="recentActivity" style="display: none;">
            <h3>Recent Activity</h3>
            <div class="activity-list" id="activityList">
                <!-- Activities will be loaded here -->
                <div class="activity-item" id="defaultActivity">
                    <div class="activity-info">
                        <div class="activity-icon deposit">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z"/>
                            </svg>
                        </div>
                        <div class="activity-details">
                            <h4>No Recent Activity</h4>
                            <span>Login to see your activity</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Guest Message - Only shown when not logged in -->
        <section class="hero" id="guestMessage" style="margin-top: 40px;">
            <h2>Start Your Gaming Journey Today!</h2>
            <p>Join thousands of players enjoying premium games, secure transactions, and exclusive rewards. Sign up now to get started!</p>
            <div class="cta-buttons">
                <a href="signup.html" class="btn btn-primary">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                    </svg>
                    Create Free Account
                </a>
                <a href="games.html" class="btn btn-secondary">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
                    </svg>
                    Try Demo Games
                </a>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <!-- [FOOTER CONTENT REMAINS THE SAME] -->
        <!-- ... your existing footer ... -->
    </footer>

    <script>
        // Enhanced Security and User Management
        class UserManager {
            constructor() {
                this.userData = null;
                this.session = null;
                this.isLoggedIn = false;
            }

            async checkLoginStatus() {
                try {
                    // Check for session
                    const sessionData = sessionStorage.getItem('xbet_session');
                    
                    if (!sessionData) {
                        this.isLoggedIn = false;
                        return false;
                    }

                    // Decrypt session
                    const session = JSON.parse(atob(sessionData));
                    this.session = session;
                    this.isLoggedIn = true;

                    // Get user data from localStorage
                    let userData = localStorage.getItem('userData_' + session.email);
                    
                    if (userData) {
                        this.userData = JSON.parse(userData);
                    } else {
                        // Also check by username
                        const currentUser = localStorage.getItem('currentUser');
                        if (currentUser) {
                            userData = localStorage.getItem('userData_' + currentUser);
                            if (userData) {
                                this.userData = JSON.parse(userData);
                            }
                        }
                    }

                    return true;
                    
                } catch (error) {
                    console.error('Error checking login status:', error);
                    this.isLoggedIn = false;
                    return false;
                }
            }

            updateBalanceDisplay() {
                if (this.userData && this.userData.balance !== undefined) {
                    const balanceElement = document.getElementById('userBalance');
                    if (balanceElement) {
                        balanceElement.textContent = `$${this.userData.balance.toFixed(2)}`;
                    }
                }
            }

            loadRecentActivity() {
                const activityList = document.getElementById('activityList');
                if (!activityList || !this.userData || !this.userData.transactions) return;

                // Clear existing activities
                activityList.innerHTML = '';

                // Show recent transactions (last 5)
                const recentTransactions = this.userData.transactions || [];
                
                if (recentTransactions.length === 0) {
                    // Show empty state
                    activityList.innerHTML = `
                        <div class="activity-item">
                            <div class="activity-info">
                                <div class="activity-icon deposit">
                                    <svg viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
                                    </svg>
                                </div>
                                <div class="activity-details">
                                    <h4>No Recent Activity</h4>
                                    <span>Start playing to see your activity here</span>
                                </div>
                            </div>
                        </div>
                    `;
                    return;
                }

                recentTransactions.slice(-5).reverse().forEach(transaction => {
                    const isDeposit = transaction.type === 'deposit' || transaction.amount > 0;
                    const iconType = isDeposit ? 'deposit' : 'withdraw';
                    const amountClass = isDeposit ? 'positive' : 'negative';
                    const amountPrefix = isDeposit ? '+' : '-';
                    
                    const activityItem = document.createElement('div');
                    activityItem.className = 'activity-item';
                    activityItem.innerHTML = `
                        <div class="activity-info">
                            <div class="activity-icon ${iconType}">
                                <svg viewBox="0 0 24 24" fill="currentColor">
                                    ${isDeposit ? 
                                        '<path d="M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z"/>' :
                                        '<path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>'
                                    }
                                </svg>
                            </div>
                            <div class="activity-details">
                                <h4>${transaction.type || 'Transaction'}</h4>
                                <span>${new Date(transaction.date || Date.now()).toLocaleDateString()}</span>
                            </div>
                        </div>
                        <div class="activity-amount ${amountClass}">
                            ${amountPrefix}$${Math.abs(transaction.amount).toFixed(2)}
                        </div>
                    `;
                    
                    activityList.appendChild(activityItem);
                });
            }

            logout() {
                // Clear all session data
                sessionStorage.removeItem('xbet_session');
                localStorage.removeItem('session_expiry');
                localStorage.removeItem('currentUser');
                
                // Redirect to index (public home)
                window.location.href = 'index.html';
            }

            requireLoginForPage(page) {
                if (page === 'dashboard.html' || page === 'profile.html' || 
                    page === 'deposit.html' || page === 'withdraw.html') {
                    
                    if (!this.isLoggedIn) {
                        alert('Please login to access this page');
                        window.location.href = 'login.html';
                        return false;
                    }
                }
                return true;
            }
        }

        // Update UI based on login status
        function updateUIForLoginStatus(isLoggedIn, userManager) {
            if (isLoggedIn) {
                // Show logged-in UI
                document.getElementById('balanceContainer').style.display = 'flex';
                document.getElementById('loggedInActions').style.display = 'flex';
                document.getElementById('guestActions').style.display = 'none';
                document.getElementById('recentActivity').style.display = 'block';
                document.getElementById('guestMessage').style.display = 'none';
                
                // Update balance
                userManager.updateBalanceDisplay();
                
                // Load activity
                userManager.loadRecentActivity();
                
                // Update dashboard button text
                document.getElementById('dashboardBtn').innerHTML = `
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/>
                    </svg>
                    My Dashboard
                `;
                
            } else {
                // Show guest UI
                document.getElementById('balanceContainer').style.display = 'none';
                document.getElementById('loggedInActions').style.display = 'none';
                document.getElementById('guestActions').style.display = 'flex';
                document.getElementById('recentActivity').style.display = 'none';
                document.getElementById('guestMessage').style.display = 'block';
                
                // Reset dashboard button
                document.getElementById('dashboardBtn').innerHTML = `
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/>
                    </svg>
                    Go to Dashboard
                `;
                
                // Add login requirement for protected pages
                document.getElementById('dashboardLink').addEventListener('click', function(e) {
                    e.preventDefault();
                    alert('Please login to access the Dashboard');
                    window.location.href = 'login.html';
                });
                
                document.getElementById('dashboardBtn').addEventListener('click', function(e) {
                    e.preventDefault();
                    alert('Please login to access the Dashboard');
                    window.location.href = 'login.html';
                });
                
                document.getElementById('depositAction').addEventListener('click', function(e) {
                    e.preventDefault();
                    alert('Please login to deposit funds');
                    window.location.href = 'login.html';
                });
                
                document.getElementById('withdrawAction').addEventListener('click', function(e) {
                    e.preventDefault();
                    alert('Please login to withdraw funds');
                    window.location.href = 'login.html';
                });
                
                document.getElementById('profileAction').addEventListener('click', function(e) {
                    e.preventDefault();
                    alert('Please login to access profile settings');
                    window.location.href = 'login.html';
                });
            }
        }

        // Mobile Menu Toggle
        function initMobileMenu() {
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const navLinks = document.getElementById('navLinks');

            if (mobileMenuBtn && navLinks) {
                mobileMenuBtn.addEventListener('click', () => {
                    navLinks.classList.toggle('active');
                });

                // Close menu when clicking outside
                document.addEventListener('click', (event) => {
                    if (!navLinks.contains(event.target) && !mobileMenuBtn.contains(event.target)) {
                        navLinks.classList.remove('active');
                    }
                });
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', async () => {
            // Initialize mobile menu
            initMobileMenu();

            // Initialize user manager
            const userManager = new UserManager();
            
            // Check login status
            const isLoggedIn = await userManager.checkLoginStatus();
            
            // Update UI based on login status
            updateUIForLoginStatus(isLoggedIn, userManager);

            // Add logout functionality
            const logoutLink = document.getElementById('logoutLink');
            if (logoutLink) {
                logoutLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    userManager.logout();
                });
            }

            // Update balance periodically for logged-in users
            if (isLoggedIn) {
                setInterval(() => {
                    userManager.updateBalanceDisplay();
                }, 30000); // Every 30 seconds
            }

            // Security: Auto-logout on inactivity (only for logged-in users)
            if (isLoggedIn) {
                let inactivityTimer;
                function resetInactivityTimer() {
                    clearTimeout(inactivityTimer);
                    inactivityTimer = setTimeout(() => {
                        userManager.logout();
                    }, 30 * 60 * 1000); // 30 minutes
                }

                // Reset timer on user activity
                ['mousemove', 'keydown', 'click', 'scroll'].forEach(event => {
                    window.addEventListener(event, resetInactivityTimer);
                });

                // Start the inactivity timer
                resetInactivityTimer();
            }
        });
    </script>
</body>
</html>
