// Main signup handler
            signupForm.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                // 1. Get Form Values
                const username = document.getElementById('username').value.trim();
                const email = document.getElementById('email').value.trim();
                const password = document.getElementById('password').value;
                const confirmPassword = document.getElementById('confirmPassword').value;
                const terms = document.getElementById('terms').checked;

                // 2. Comprehensive Validation
                if (!isValidUsername(username)) {
                    showMessage('Username must be 3-20 characters (letters, numbers, underscores only)', 'error');
                    return;
                }

                if (!isValidEmail(email)) {
                    showMessage('Please enter a valid email address', 'error');
                    return;
                }

                if (password.length < 6) {
                    showMessage('Password must be at least 6 characters long', 'error');
                    return;
                }

                if (password !== confirmPassword) {
                    showMessage('Passwords do not match!', 'error');
                    return;
                }

                if (!terms) {
                    showMessage('You must agree to the Terms & Conditions', 'error');
                    return;
                }

                // 3. UI State: Loading
                submitBtn.disabled = true;
                submitBtn.innerHTML = '<span class="loading"></span> Encrypting Data...';

                try {
                    // 4. Register in Local System (XBetStorage)
                    const result = storage.registerUser(username, email, password);

                    if (result.success) {
                        // Create Session for immediate access
                        createUserSession(result.userData);

                        // Success UI with Transaction Code
                        const successHTML = `
                            <div style="text-align:center">
                                <strong style="font-size: 18px;">Account Created Successfully!</strong><br>
                                Welcome to the platform, ${username}.<br>
                                <div class="transaction-code-display">
                                    TRANS-CODE: ${result.transactionCode}
                                </div>
                                <p style="font-size: 12px; color: #fff; margin-top: 10px;">
                                    ⚠️ Save this code! You will need it for all withdrawals.
                                </p>
                            </div>
                        `;
                        
                        showMessage(successHTML, 'success', 15000);

                        // 5. Smooth Redirect to Login
                        setTimeout(() => {
                            window.location.href = 'login.html';
                        }, 5000);

                    } else {
                        throw new Error(result.error);
                    }

                } catch (error) {
                    console.error('Signup Error:', error);
                    showMessage(error.message || 'System error during registration', 'error');
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = 'Create Account';
                }
            });
        });
    </script>
</body>
</html>
