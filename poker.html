<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>X-BET | Simple Poker</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #1a73e8;
            --primary-dark: #0d62d9;
            --secondary: #34a853;
            --accent: #ea4335;
            --dark: #0f172a;
            --light: #f8fafc;
            --gray: #64748b;
            --poker-green: #0a5c36;
            --poker-felt: #2d5016;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { background: linear-gradient(135deg, #0a3a1a, var(--poker-felt)); color: white; min-height: 100vh; }
        .header {
            background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(15px); padding: 15px 5%; border-bottom: 2px solid var(--primary);
            position: sticky; top: 0; z-index: 1000;
        }
        .nav-container {
            display: flex; justify-content: space-between; align-items: center; max-width: 1400px; margin: 0 auto;
        }
        .logo {
            display: flex; align-items: center; gap: 10px; font-size: 28px; font-weight: 800; color: white; text-decoration: none;
        }
        .logo span:first-child { color: var(--primary); } .logo span:last-child { color: var(--secondary); }
        .poker-badge { background: var(--accent); color: white; padding: 4px 12px; border-radius: 12px; font-size: 12px; margin-left: 10px; }
        .back-btn {
            background: rgba(255, 255, 255, 0.1); color: white; padding: 10px 25px; border-radius: 10px; text-decoration: none;
            font-weight: 600; display: flex; align-items: center; gap: 10px; border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s;
        }
        .back-btn:hover { background: var(--primary); transform: translateY(-2px); }
        .game-container {
            max-width: 1200px; margin: 30px auto; padding: 20px; display: flex; flex-direction: column; gap: 30px;
        }
        .game-header {
            background: rgba(255, 255, 255, 0.05); border-radius: 20px; padding: 25px; text-align: center;
            border: 2px solid rgba(255, 255, 255, 0.1);
        }
        .game-header h1 { font-size: 2.8rem; margin-bottom: 10px; color: #ffd700; }
        .game-header p { color: #cbd5e1; font-size: 1.1rem; max-width: 800px; margin: 0 auto 20px; }
        .balance-card {
            background: rgba(0, 0, 0, 0.4); border-radius: 15px; padding: 20px; display: inline-block; margin: 0 auto;
            border: 2px solid var(--secondary); min-width: 300px;
        }
        .balance-label { font-size: 14px; color: #94a3b8; margin-bottom: 5px; }
        .balance-amount { font-size: 2.5rem; font-weight: 800; color: var(--secondary); }
        .game-area {
            display: grid; grid-template-columns: 1fr 350px; gap: 25px;
        }
        .poker-table {
            background: linear-gradient(135deg, #1e4620, #2d5016); border-radius: 25px; padding: 30px; position: relative;
            border: 10px solid #8b4513; box-shadow: inset 0 0 50px rgba(0, 0, 0, 0.5), 0 20px 40px rgba(0, 0, 0, 0.4);
            min-height: 500px; display: flex; flex-direction: column; justify-content: space-between;
        }
        .dealer-area, .player-area {
            text-align: center; padding: 20px;
        }
        .area-label {
            font-size: 1.2rem; color: #ffd700; margin-bottom: 15px; font-weight: 600; display: flex; align-items: center;
            justify-content: center; gap: 10px;
        }
        .cards-container {
            display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; min-height: 130px;
        }
        .card {
            width: 90px; height: 120px; background: white; border-radius: 10px; display: flex; flex-direction: column;
            justify-content: space-between; padding: 10px; font-size: 24px; font-weight: bold; color: black;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3); border: 1px solid #ddd; position: relative;
            transition: transform 0.3s;
        }
        .card.red { color: #d22; }
        .card.back {
            background: linear-gradient(45deg, var(--primary), #8b5cf6); color: white; justify-content: center;
            align-items: center; font-size: 32px;
        }
        .card.selected { transform: translateY(-15px); box-shadow: 0 15px 25px rgba(0, 0, 0, 0.4); border-color: #ffd700; }
        .card-suit { align-self: center; font-size: 32px; }
        .hand-strength {
            margin-top: 15px; font-size: 1.1rem; color: #ffd700; font-weight: 600; min-height: 25px;
        }
        .controls-panel {
            background: rgba(255, 255, 255, 0.05); border-radius: 20px; padding: 25px; border: 1px solid rgba(255, 255, 255, 0.1);
            display: flex; flex-direction: column; gap: 20px;
        }
        .bet-controls { margin-bottom: 20px; }
        .control-title { font-size: 1.3rem; margin-bottom: 15px; color: white; display: flex; align-items: center; gap: 10px; }
        .bet-amount { display: flex; align-items: center; gap: 15px; margin-bottom: 20px; }
        .bet-input {
            flex: 1; padding: 15px; border-radius: 12px; border: 2px solid rgba(255, 255, 255, 0.2); background: rgba(255, 255, 255, 0.1);
            color: white; font-size: 1.2rem; font-weight: 600; text-align: center;
        }
        .quick-bets { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 20px; }
        .quick-bet-btn {
            padding: 12px; border-radius: 10px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2);
            color: white; cursor: pointer; transition: all 0.3s; font-weight: 600;
        }
        .quick-bet-btn:hover { background: rgba(255, 255, 255, 0.2); transform: translateY(-2px); }
        .action-buttons { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .action-btn {
            padding: 18px; border-radius: 12px; border: none; font-size: 1.1rem; font-weight: 700; cursor: pointer;
            transition: all 0.3s; display: flex; align-items: center; justify-content: center; gap: 10px;
        }
        .btn-draw { background: linear-gradient(135deg, var(--primary), var(--primary-dark)); color: white; }
        .btn-stand { background: linear-gradient(135deg, #f59e0b, #d97706); color: white; }
        .btn-new { background: linear-gradient(135deg, var(--secondary), #059669); color: white; }
        .btn-fold { background: linear-gradient(135deg, var(--accent), #dc2626); color: white; }
        .btn-draw:hover, .btn-stand:hover, .btn-new:hover, .btn-fold:hover { transform: translateY(-3px); filter: brightness(1.1); }
        .btn-disabled { opacity: 0.5; cursor: not-allowed !important; }
        .btn-disabled:hover { transform: none !important; filter: none !important; }
        .game-log {
            background: rgba(0, 0, 0, 0.5); border-radius: 15px; padding: 20px; flex: 1; overflow-y: auto; max-height: 200px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .log-title { font-size: 1.1rem; margin-bottom: 15px; color: #ffd700; }
        .log-messages { display: flex; flex-direction: column; gap: 8px; }
        .log-message {
            padding: 10px 15px; background: rgba(255, 255, 255, 0.05); border-radius: 8px; border-left: 4px solid;
            font-size: 0.95rem;
        }
        .log-info { border-left-color: var(--primary); }
        .log-win { border-left-color: var(--secondary); background: rgba(52, 168, 83, 0.1); }
        .log-loss { border-left-color: var(--accent); background: rgba(239, 68, 68, 0.1); }
        .log-action { border-left-color: #f59e0b; }
        .game-rules {
            background: rgba(255, 255, 255, 0.05); border-radius: 15px; padding: 20px; margin-top: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .rules-title { font-size: 1.2rem; margin-bottom: 15px; color: white; }
        .rules-list { list-style: none; }
        .rules-list li { margin-bottom: 10px; padding-left: 25px; position: relative; color: #cbd5e1; }
        .rules-list li:before { content: "â€¢"; color: var(--primary); position: absolute; left: 10px; font-size: 1.5rem; }
        @media (max-width: 992px) { .game-area { grid-template-columns: 1fr; } }
        @media (max-width: 768px) { 
            .nav-container { flex-direction: column; gap: 15px; } 
            .game-header h1 { font-size: 2rem; }
            .action-buttons { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="nav-container">
            <a href="games.html" class="logo">
                <span>X</span>-<span>BET</span>
                <span class="poker-badge">POKER</span>
            </a>
            <a href="games.html" class="back-btn"><i class="fas fa-arrow-left"></i>Back to Games Hub</a>
        </div>
    </header>

    <main class="game-container">
        <div class="game-header">
            <h1><i class="fas fa-cards"></i> Simple 5-Card Draw Poker</h1>
            <p>Play a quick round of poker against the computer. Draw new cards to improve your hand, but be careful with your bets!</p>
            <div class="balance-card">
                <div class="balance-label">Your Poker Balance</div>
                <div class="balance-amount" id="playerBalance">$0.00</div>
            </div>
        </div>

        <div class="game-area">
            <div class="poker-table">
                <div class="dealer-area">
                    <div class="area-label"><i class="fas fa-robot"></i> Dealer's Hand</div>
                    <div class="cards-container" id="dealerCards">
                        <!-- Dealer cards appear here -->
                    </div>
                    <div class="hand-strength" id="dealerHandText">Dealer is thinking...</div>
                </div>
                
                <div class="player-area">
                    <div class="area-label"><i class="fas fa-user"></i> Your Hand (Click cards to discard)</div>
                    <div class="cards-container" id="playerCards">
                        <!-- Player cards appear here -->
                    </div>
                    <div class="hand-strength" id="playerHandText">Your hand will appear here</div>
                </div>
            </div>

            <div class="controls-panel">
                <div class="bet-controls">
                    <div class="control-title"><i class="fas fa-coins"></i> Place Your Bet</div>
                    <div class="bet-amount">
                        <input type="number" class="bet-input" id="betAmount" value="10" min="1" step="1">
                        <button class="quick-bet-btn" onclick="setBet(25)">$25</button>
                    </div>
                    <div class="quick-bets">
                        <button class="quick-bet-btn" onclick="setBet(5)">$5</button>
                        <button class="quick-bet-btn" onclick="setBet(10)">$10</button>
                        <button class="quick-bet-btn" onclick="setBet(50)">$50</button>
                        <button class="quick-bet-btn" onclick="setBet(100)">$100</button>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="action-btn btn-draw" id="drawBtn" onclick="playerDraw()">
                        <i class="fas fa-sync-alt"></i> Draw Cards
                    </button>
                    <button class="action-btn btn-stand" id="standBtn" onclick="playerStand()">
                        <i class="fas fa-hand-paper"></i> Stand
                    </button>
                    <button class="action-btn btn-new" id="newGameBtn" onclick="startNewGame()">
                        <i class="fas fa-plus-circle"></i> New Game
                    </button>
                    <button class="action-btn btn-fold" id="foldBtn" onclick="playerFold()">
                        <i class="fas fa-flag"></i> Fold
                    </button>
                </div>

                <div class="game-log">
                    <div class="log-title"><i class="fas fa-scroll"></i> Game Log</div>
                    <div class="log-messages" id="gameLog">
                        <div class="log-message log-info">Welcome to X-BET Poker! Place a bet to start.</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="game-rules">
            <div class="rules-title"><i class="fas fa-info-circle"></i> How to Play (5-Card Draw)</div>
            <ul class="rules-list">
                <li><strong>Place a bet</strong> before the cards are dealt</li>
                <li>You and the dealer each get <strong>5 cards</strong></li>
                <li>Click on cards you want to <strong>discard</strong> (they will highlight)</li>
                <li>Press <strong>"Draw Cards"</strong> to replace selected cards with new ones</li>
                <li>Press <strong>"Stand"</strong> to keep your current hand</li>
                <li>The dealer will then draw cards (0-3) to improve its hand</li>
                <li>Best poker hand wins! Your bet is doubled if you win.</li>
                <li><strong>Fold</strong> anytime to surrender and lose half your bet</li>
            </ul>
        </div>
    </main>

    <script>
        // ===== GAME STATE =====
        let gameState = {
            playerBalance: 0,
            currentBet: 10,
            gameActive: false,
            playerHand: [],
            dealerHand: [],
            playerSelected: [], // Indexes of cards player wants to discard
            deck: [],
            round: 0
        };

        // ===== POKER HAND RANKINGS =====
        const handRanks = [
            "High Card", "One Pair", "Two Pair", "Three of a Kind", 
            "Straight", "Flush", "Full House", "Four of a Kind", 
            "Straight Flush", "Royal Flush"
        ];

        // ===== INITIALIZE GAME =====
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ðŸŽ´ X-BET Poker Initializing...');
            loadUserBalance();
            createDeck();
            updateDisplay();
            addLogMessage("Game ready. Loaded your balance.", "info");
        });

        // ===== USER BALANCE INTEGRATION =====
        function loadUserBalance() {
            try {
                // Try to get from session (like your dashboard)
                const sessionData = sessionStorage.getItem('xbet_session');
                if (sessionData) {
                    const session = JSON.parse(atob(sessionData));
                    gameState.playerBalance = session.balance || 100.00; // Default to $100 if not found
                } else {
                    // Fallback to localStorage
                    const userName = localStorage.getItem('currentUser') || 'Player';
                    const userData = JSON.parse(localStorage.getItem('userData_' + userName) || '{}');
                    gameState.playerBalance = userData.balance || 100.00;
                }
                console.log(`ðŸ’° Loaded balance: $${gameState.playerBalance}`);
            } catch (error) {
                console.error('Balance load error:', error);
                gameState.playerBalance = 100.00; // Default starting balance
            }
        }

        function updateBalanceDisplay() {
            document.getElementById('playerBalance').textContent = `$${gameState.playerBalance.toFixed(2)}`;
        }

        function saveBalanceToSession() {
            // Update the session with new balance
            try {
                const sessionData = sessionStorage.getItem('xbet_session');
                if (sessionData) {
                    const session = JSON.parse(atob(sessionData));
                    session.balance = gameState.playerBalance;
                    sessionStorage.setItem('xbet_session', btoa(JSON.stringify(session)));
                }
                
                // Also update localStorage for fallback
                const userName = localStorage.getItem('currentUser') || 'Player';
                const userData = JSON.parse(localStorage.getItem('userData_' + userName) || '{}');
                userData.balance = gameState.playerBalance;
                localStorage.setItem('userData_' + userName, JSON.stringify(userData));
                
                console.log('ðŸ’¾ Balance saved:', gameState.playerBalance);
            } catch (error) {
                console.error('Balance save error:', error);
            }
        }

        // ===== DECK MANAGEMENT =====
        function createDeck() {
            gameState.deck = [];
            const suits = ['â™ ', 'â™¥', 'â™¦', 'â™£'];
            const values = ['2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A'];
            
            for (let suit of suits) {
                for (let value of values) {
                    gameState.deck.push({
                        suit: suit,
                        value: value,
                        color: (suit === 'â™¥' || suit === 'â™¦') ? 'red' : 'black',
                        code: value + suit
                    });
                }
            }
            shuffleDeck();
        }

        function shuffleDeck() {
            for (let i = gameState.deck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [gameState.deck[i], gameState.deck[j]] = [gameState.deck[j], gameState.deck[i]];
            }
        }

        function dealCard() {
            return gameState.deck.pop();
        }

        // ===== GAME CONTROLS =====
        function setBet(amount) {
            if (gameState.gameActive) {
                addLogMessage("Cannot change bet during active game.", "info");
                return;
            }
            
            gameState.currentBet = amount;
            document.getElementById('betAmount').value = amount;
            addLogMessage(`Bet set to $${amount}`, "action");
        }

        function startNewGame() {
            // Check balance first - MOST IMPORTANT RULE
            if (gameState.playerBalance < gameState.currentBet) {
                addLogMessage(`âŒ Insufficient balance! You need $${gameState.currentBet} but have $${gameState.playerBalance.toFixed(2)}`, "loss");
                return;
            }

            // Deduct bet from balance
            gameState.playerBalance -= gameState.currentBet;
            gameState.gameActive = true;
            gameState.round++;
            gameState.playerSelected = [];
            
            // Create fresh deck and deal
            createDeck();
            gameState.playerHand = [dealCard(), dealCard(), dealCard(), dealCard(), dealCard()];
            gameState.dealerHand = [dealCard(), dealCard(), dealCard(), dealCard(), dealCard()];
            
            updateDisplay();
            updateBalanceDisplay();
            saveBalanceToSession();
            
            addLogMessage(`ðŸ’° Round ${gameState.round} started! Bet: $${gameState.currentBet}`, "action");
            addLogMessage("Select cards to discard, then press 'Draw Cards' or 'Stand'", "info");
            
            // Update button states
            document.getElementById('drawBtn').classList.remove('btn-disabled');
            document.getElementById('standBtn').classList.remove('btn-disabled');
            document.getElementById('foldBtn').classList.remove('btn-disabled');
            document.getElementById('newGameBtn').classList.add('btn-disabled');
        }

        function playerDraw() {
            if (!gameState.gameActive) {
                addLogMessage("Start a new game first!", "info");
                return;
            }

            // Replace selected cards
            for (let i = 0; i < gameState.playerSelected.length; i++) {
                const index = gameState.playerSelected[i];
                if (index >= 0 && index < 5) {
                    gameState.playerHand[index] = dealCard();
                }
            }
            
            gameState.playerSelected = [];
            addLogMessage(`Drew ${gameState.playerSelected.length} new card(s)`, "action");
            
            // Dealer's turn (simple AI)
            dealerPlay();
            
            updateDisplay();
        }

        function playerStand() {
            if (!gameState.gameActive) {
                addLogMessage("Start a new game first!", "info");
                return;
            }
            
            addLogMessage("You stand with your current hand", "action");
            
            // Dealer's turn
            dealerPlay();
            
            updateDisplay();
        }

        function playerFold() {
            if (!gameState.gameActive) {
                addLogMessage("No active game to fold!", "info");
                return;
            }
            
            const lossAmount = gameState.currentBet * 0.5; // Lose half on fold
            addLogMessage(`You folded. Lost $${lossAmount.toFixed(2)}`, "loss");
            
            gameState.gameActive = false;
            gameState.playerBalance -= lossAmount; // Additional loss for folding
            
            updateBalanceDisplay();
            saveBalanceToSession();
            document.getElementById('newGameBtn').classList.remove('btn-disabled');
        }

        function dealerPlay() {
            // Simple dealer AI: Draw 0-3 cards based on hand strength
            const dealerHandValue = evaluateHand(gameState.dealerHand);
            const dealerRankIndex = handRanks.indexOf(dealerHandValue.rank);
            
            let cardsToDraw = 0;
            if (dealerRankIndex < 3) cardsToDraw = 3; // Poor hand, draw 3
            else if (dealerRankIndex < 5) cardsToDraw = 2; // Average hand, draw 2
            else if (dealerRankIndex < 7) cardsToDraw = 1; // Good hand, draw 1
            // else cardsToDraw = 0; // Great hand, stand pat
            
            // Draw cards for dealer
            for (let i = 0; i < cardsToDraw; i++) {
                // Find worst card to replace (simplified)
                gameState.dealerHand[i] = dealCard();
            }
            
            addLogMessage(`Dealer draws ${cardsToDraw} card(s)`, "action");
            
            // Determine winner
            determineWinner();
        }

        function determineWinner() {
            const playerResult = evaluateHand(gameState.playerHand);
            const dealerResult = evaluateHand(gameState.dealerHand);
            
            document.getElementById('playerHandText').textContent = `Your hand: ${playerResult.rank}`;
            document.getElementById('dealerHandText').textContent = `Dealer's hand: ${dealerResult.rank}`;
            
            let playerWins = false;
            let tie = false;
            
            // Compare hand ranks first
            const playerRankIndex = handRanks.indexOf(playerResult.rank);
            const dealerRankIndex = handRanks.indexOf(dealerResult.rank);
            
            if (playerRankIndex > dealerRankIndex) {
                playerWins = true;
            } else if (playerRankIndex === dealerRankIndex) {
                // Same rank, compare high card
                if (playerResult.score > dealerResult.score) {
                    playerWins = true;
                } else if (playerResult.score === dealerResult.score) {
                    tie = true;
                }
            }
            
            // Calculate winnings
            if (tie) {
                gameState.playerBalance += gameState.currentBet; // Return bet
                addLogMessage(`It's a tie! Your bet of $${gameState.currentBet} is returned.`, "info");
            } else if (playerWins) {
                const winnings = gameState.currentBet * 2; // Double your money!
                gameState.playerBalance += winnings;
                addLogMessage(`ðŸŽ‰ YOU WIN! +$${winnings.toFixed(2)} (${playerResult.rank} beats ${dealerResult.rank})`, "win");
            } else {
                addLogMessage(`ðŸ’¸ You lose. Dealer's ${dealerResult.rank} beats your ${playerResult.rank}`, "loss");
            }
            
            gameState.gameActive = false;
            updateBalanceDisplay();
            saveBalanceToSession();
            
            // Enable new game button
            document.getElementById('newGameBtn').classList.remove('btn-disabled');
            document.getElementById('drawBtn').classList.add('btn-disabled');
            document.getElementById('standBtn').classList.add('btn-disabled');
            document.getElementById('foldBtn').classList.add('btn-disabled');
        }

        // ===== CARD INTERACTION =====
        function toggleCardSelection(index) {
            if (!gameState.gameActive) return;
            
            const idx = gameState.playerSelected.indexOf(index);
            if (idx === -1) {
                gameState.playerSelected.push(index);
            } else {
                gameState.playerSelected.splice(idx, 1);
            }
            
            updateDisplay();
        }

        // ===== POKER HAND EVALUATION (Simplified) =====
        function evaluateHand(hand) {
            // This is a simplified evaluator for demo purposes
            const values = hand.map(card => {
                const val = card.value;
                if (val === 'A') return 14;
                if (val === 'K') return 13;
                if (val === 'Q') return 12;
                if (val === 'J') return 11;
                return parseInt(val);
            }).sort((a, b) => b - a);
            
            const suits = hand.map(card => card.suit);
            const valueCounts = {};
            values.forEach(v => valueCounts[v] = (valueCounts[v] || 0) + 1);
            
            // Check for pairs, three of a kind, etc.
            const counts = Object.values(valueCounts).sort((a, b) => b - a);
            
            // Check flush
            const isFlush = suits.every(suit => suit === suits[0]);
            
            // Check straight
            const isStraight = values.every((v, i, arr) => i === 0 || arr[i-1] - v === 1);
            
            // Royal/Straight flush check
            if (isFlush && isStraight) {
                if (values[0] === 14 && values[4] === 10) {
                    return { rank: "Royal Flush", score: 1000 };
                }
                return { rank: "Straight Flush", score: 900 + values[0] };
            }
            
            // Four of a kind
            if (counts[0] === 4) {
                return { rank: "Four of a Kind", score: 800 + values[0] };
            }
            
            // Full house
            if (counts[0] === 3 && counts[1] === 2) {
                return { rank: "Full House", score: 700 + values[0] };
            }
            
            // Flush
            if (isFlush) {
                return { rank: "Flush", score: 600 + values[0] };
            }
            
            // Straight
            if (isStraight) {
                return { rank: "Straight", score: 500 + values[0] };
            }
            
            // Three of a kind
            if (counts[0] === 3) {
                return { rank: "Three of a Kind", score: 400 + values[0] };
            }
            
            // Two pair
            if (counts[0] === 2 && counts[1] === 2) {
                return { rank: "Two Pair", score: 300 + values[0] };
            }
            
            // One pair
            if (counts[0] === 2) {
                return { rank: "One Pair", score: 200 + values[0] };
            }
            
            // High card
            return { rank: "High Card", score: 100 + values[0] };
        }

        // ===== DISPLAY FUNCTIONS =====
        function updateDisplay() {
            updateBalanceDisplay();
            
            // Update player cards
            const playerContainer = document.getElementById('playerCards');
            playerContainer.innerHTML = '';
            
            gameState.playerHand.forEach((card, index) => {
                const cardEl = document.createElement('div');
                cardEl.className = `card ${card.color === 'red' ? 'red' : ''}`;
                if (gameState.playerSelected.includes(index)) {
                    cardEl.classList.add('selected');
                }
                
                cardEl.innerHTML = `
                    <div>${card.value}</div>
                    <div class="card-suit">${card.suit}</div>
                    <div style="transform: rotate(180deg)">${card.value}</div>
                `;
                
                cardEl.onclick = () => toggleCardSelection(index);
                playerContainer.appendChild(cardEl);
            });
            
            // Update dealer cards
            const dealerContainer = document.getElementById('dealerCards');
            dealerContainer.innerHTML = '';
            
            gameState.dealerHand.forEach((card, index) => {
                const cardEl = document.createElement('div');
                if (gameState.gameActive) {
                    // Show dealer's cards face down during player's turn
                    cardEl.className = 'card back';
                    cardEl.innerHTML = `<div>ðŸŽ´</div>`;
                } else {
                    // Show face up after round ends
                    cardEl.className = `card ${card.color === 'red' ? 'red' : ''}`;
                    cardEl.innerHTML = `
                        <div>${card.value}</div>
                        <div class="card-suit">${card.suit}</div>
                        <div style="transform: rotate(180deg)">${card.value}</div>
                    `;
                }
                dealerContainer.appendChild(cardEl);
            });
            
            // Update hand texts
            if (gameState.gameActive) {
                const playerResult = evaluateHand(gameState.playerHand);
                document.getElementById('playerHandText').textContent = 
                    `Your hand: ${playerResult.rank} | Select ${gameState.playerSelected.length} card(s) to discard`;
                document.getElementById('dealerHandText').textContent = `Dealer's hand: ???`;
            }
        }

        function addLogMessage(message, type = "info") {
            const logContainer = document.getElementById('gameLog');
            const messageEl = document.createElement('div');
            messageEl.className = `log-message log-${type}`;
            messageEl.innerHTML = `<i class="fas fa-${type === 'win' ? 'trophy' : type === 'loss' ? 'times-circle' : 'info-circle'}"></i> ${message}`;
            
            logContainer.prepend(messageEl);
            
            // Keep only last 10 messages
            while (logContainer.children.length > 10) {
                logContainer.removeChild(logContainer.lastChild);
            }
        }

        // ===== INITIAL CALL =====
        updateDisplay();
    </script>
</body>
</html>
